WITH customer_orders AS (
  SELECT 
    Customer_ID,
    Order_ID,
    Order_Date,
    LAG(Order_Date) OVER (PARTITION BY Customer_ID ORDER BY Order_Date) AS Previous_Order_Date
  FROM retail_sales
)
SELECT *,
       DATEDIFF(Order_Date, Previous_Order_Date) AS Days_Between_Orders
FROM customer_orders
WHERE Previous_Order_Date IS NOT NULL;
